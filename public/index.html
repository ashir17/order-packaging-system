<!DOCTYPE html>
<html>
<head>
  <title>Order Packaging System</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body class="bg-light">

<div class="container mt-5">
  <div class="card shadow">
    <div class="card-header bg-primary text-white">
      <h4 class="mb-0">Order Packaging System</h4>
    </div>
    <div class="card-body">
      <h5>Select Items</h5>
      <div id="items" class="mb-3"></div>
      <button id="order" class="btn btn-success">Place Order</button>
      <hr>
      <h5>Result</h5>
      <pre id="result" class="bg-dark text-white p-3 rounded"></pre>
    </div>
  </div>
</div>

<script>
$(document).ready(function () {

  // Load items from backend
  $.get('/api/items', function (items) {
    items.forEach(item => {
      $('#items').append(`
        <div class="form-check">
          <input class="form-check-input" type="checkbox"
                value='${JSON.stringify(item)}'
                id="item${item.id}">
          <label class="form-check-label" for="item${item.id}">
            ${item.name} - $${item.price} - ${item.weight}g
          </label>
        </div>
      `);
    });
  }).fail(function() {
    alert('Failed to load items from server');
  });

  // Place order
  $('#order').click(function () {
    let selected = [];
    $('input:checked').each(function () {
      selected.push(JSON.parse($(this).val()));
    });

    if (selected.length === 0) {
      alert('Please select at least one item');
      return;
    }

    $.ajax({
      url: '/api/place-order',
      method: 'POST',
      contentType: 'application/json',
      data: JSON.stringify(selected),
      success: function (result) {
        $('#result').text(JSON.stringify(result, null, 2));
      },
      error: function() {
        alert('Failed to place order');
      }
    });
  });

});
</script>

</body>
</html>
